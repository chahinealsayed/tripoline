var rt=Object.defineProperty;var at=(r,s,a)=>s in r?rt(r,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[s]=a;var M=(r,s,a)=>(at(r,typeof s!="symbol"?s+"":s,a),a);import{B as Q,_ as lt,M as ot,b as j,s as I}from"./StringInput.vue_vue_type_script_setup_true_lang.js";import{a as nt,n as it}from"./strings.js";import{l as G}from"./index.js";import{d as W,c as F,k as p,p as x,u as ct,C as dt,a as _,q as d,s as S,l as D,r as $,v as V,F as J,t as ut}from"./mc55b2a42316522d6.js";import{c as ft,F as C,f as pt,C as ht,_ as gt}from"./ModalForm.vue_vue_type_script_setup_true_lang.js";import{_ as R}from"./TextInput.vue_vue_type_script_setup_true_lang.js";import{I as U}from"./Icon.js";import{m as yt,a as _t}from"./m6cd080c8112b9076.js";import{r as B,u as k}from"./m6bdda40d8bd2cf5a.js";import{K as P}from"./ma6cfd38af5d4c661.js";class bt{constructor(s){M(this,"_action",()=>{});M(this,"_events",{});this.count=s}set action(s){this._action=s}get action(){return this._action}on(s,a){this._events.hasOwnProperty(s)||(this._events[s]=[]),this._events[s].push(a)}dispatch(s,a=null){if(this._events.hasOwnProperty(s))for(const m of this._events[s])m(new CustomEvent(s,{bubbles:!0,detail:{target:this,data:a}}))}start(){this.dispatch("start"),X(this)}}function X(r,s=0){kt(r,s),r.count>s?r.action(s,()=>{X(r,s+1)}):r.dispatch("done")}function kt(r,s){let a=Math.ceil(s*100/r.count);a>100&&(a=100),r.dispatch("progress",{current:s,total:r.count,percentage:a})}function mt(r){return new bt(r)}const A=W({__name:"Badge",props:{color:{default:"primary"},bgColor:{default:null},pill:{type:Boolean,default:!1}},setup(r){const s=F(()=>{const a={badge:!0};return r.bgColor?(a[`text-${r.color}`]=!0,a[`bg-${r.bgColor}`]=!0):a[`text-bg-${r.color}`]=!0,r.pill&&(a["rounded-pill"]=!0),a});return(a,m)=>(p(),x("span",dt({class:s.value},a.$attrs),[ct(a.$slots,"default")],16))}}),vt=["innerHTML"],wt={class:"d-flex flex-horizontal gap-2"},St={key:0,class:"d-flex flex-horizontal gap-2"},$t=["innerHTML"],Ct={class:"mb-3"},xt={class:"mb-3"},Tt={class:"mb-3"},Ot=W({__name:"Seo",props:{target:{}},setup(r){const s=ft({type:C.Number,name:"id",label:"ID",sortable:!0,searchable:!0,fitable:!0},{type:C.String,name:"title",label:"Title",sortable:!0,searchable:!0},{type:C.String,name:"description",label:"Description",sortable:!0,searchable:!0},{type:C.String,name:"keywords",label:"Keywords",sortable:!0,searchable:!0,fitable:!0},{type:C.String,name:"target",label:"Page",sortable:!0,searchable:!0,fitable:!0}),a=B(null),m=B(null),E=B(null),L=B(!1);class Y extends ot{get id(){var e;return this.field("id","ID",((e=this.initData)==null?void 0:e.id)??null)}get target(){var e;return this.field("target","Target",((e=this.initData)==null?void 0:e.target)??null)}get title(){var e;return this.field("title","Title",((e=this.initData)==null?void 0:e.title)??"")}get description(){var e;return this.field("description","Description",((e=this.initData)==null?void 0:e.description)??"")}get keywords(){var e;return this.field("keywords","Keywords",((e=this.initData)==null?void 0:e.keywords)??[],"Separate keywords by comma")}get rules(){return[]}}const H=o=>{L.value=o},Z=()=>{var l,h,i,g,b;(h=(l=E.value)==null?void 0:l.start)==null||h.call(l);const o=(b=(g=(i=a.value)==null?void 0:i.data)==null?void 0:g.call(i))==null?void 0:b.map(n=>{var u;return(u=n.target)==null?void 0:u.split("-").at(1)}),e=G().filter(({value:n})=>!o.includes(n)),t=mt(e.length);t.action=(n,u)=>{var c,y;j().post("/seo",{target:`${r.target}${(y=(c=e==null?void 0:e.at)==null?void 0:c.call(e,n))==null?void 0:y.value}`,keywords:[],description:"",title:`Seo Title ${new Date().getTime()}`}).then(()=>{u()})},t.on("done",()=>{var n,u,c,y;I("Seo Created Successfully"),(u=(n=a.value)==null?void 0:n.refresh)==null||u.call(n),(y=(c=E.value)==null?void 0:c.stop)==null||y.call(c)}),t.start()},q=o=>{var t,l;const e={...o};e.keywords=e.keywords.join(`
`),(l=(t=m.value)==null?void 0:t.open)==null||l.call(t,e)},tt=(o,e)=>{var l,h;const t=o.data;t.keywords=((h=(l=t.keywords)==null?void 0:l.split)==null?void 0:h.call(l,","))??[],j().put(`/seo/${t.id}`,t).finally(()=>{var i,g;I("Seo Created Successfully"),(g=(i=a.value)==null?void 0:i.refresh)==null||g.call(i),e()})},et=F(()=>{if(r.target)return{filter:{target:{like:r.target}}}}),st=F(()=>{var o,e,t;return((e=(o=a.value)==null?void 0:o.length)==null?void 0:e.call(o))<((t=G())==null?void 0:t.length)});return(o,e)=>(p(),x(J,null,[_(ht,{ref_key:"crud",ref:a,fields:k(s),fetch:k(pt)("/seo",void 0,et.value),onEmpty:e[0]||(e[0]=t=>H(!0)),onNoEmpty:e[1]||(e[1]=t=>H(!1))},{descriptionValue:d(({item:t})=>[S("div",{innerHTML:k(nt)((t==null?void 0:t.description)??"")},null,8,vt)]),targetValue:d(({item:t})=>{var l,h,i,g,b,n,u,c,y,K;return[S("div",wt,[(u=(n=(b=(g=(i=(h=(l=t==null?void 0:t.target)==null?void 0:l.split)==null?void 0:h.call(l,"-"))==null?void 0:i[0])==null?void 0:g.toString())==null?void 0:b.split)==null?void 0:n.call(b,":"))!=null&&u[0]?(p(),D(A,{key:0,color:"primary"},{default:d(()=>{var f,v,w,O,T,z,N;return[$(P(((N=(z=(T=(O=(w=(v=(f=t==null?void 0:t.target)==null?void 0:f.split)==null?void 0:v.call(f,"-"))==null?void 0:w[0])==null?void 0:O.toString())==null?void 0:T.split)==null?void 0:z.call(T,":"))==null?void 0:N[0])??""),1)]}),_:2},1024)):V("",!0),(K=(y=(c=t==null?void 0:t.target)==null?void 0:c.split)==null?void 0:y.call(c,"-"))!=null&&K[1]?(p(),D(A,{key:1,color:"info"},{default:d(()=>{var f,v,w;return[$(P(((w=(v=(f=t==null?void 0:t.target)==null?void 0:f.split)==null?void 0:v.call(f,"-"))==null?void 0:w[1])??""),1)]}),_:2},1024)):V("",!0)])]}),keywordsValue:d(({item:t})=>[Array.isArray(t.keywords)&&t.keywords.length>0?(p(),x("div",St,[(p(!0),x(J,null,ut(t.keywords,l=>(p(),D(A,{key:l,color:"warning"},{default:d(()=>[$(P(l),1)]),_:2},1024))),128))])):(p(),x("div",{key:1,innerHTML:k(it)()},null,8,$t))]),actions:d(({item:t})=>[_(Q,{color:"info",class:"text-light",onClick:l=>q(t)},{default:d(()=>[_(U,{path:k(yt),color:"light"},null,8,["path"]),$("Edit ")]),_:2},1032,["onClick"])]),topActions:d(()=>[o.target&&(L.value||st.value)?(p(),D(Q,{key:0,ref_key:"adder",ref:E,color:"primary",class:"text-light",onClick:Z},{default:d(()=>[_(U,{path:k(_t),color:"light"},null,8,["path"]),$("Add Seo ")]),_:1},512)):V("",!0)]),_:1},8,["fields","fetch"]),_(gt,{ref_key:"modal",ref:m,name:"SEO","model-class":Y,onSave:tt},{default:d(({model:t})=>[S("div",Ct,[_(lt,{field:t.title},null,8,["field"])]),S("div",xt,[_(R,{field:t.description,style:{height:"200px"}},null,8,["field"])]),S("div",Tt,[_(R,{field:t.keywords,style:{height:"200px"}},null,8,["field"])])]),_:1},512)],64))}});export{Ot as _};

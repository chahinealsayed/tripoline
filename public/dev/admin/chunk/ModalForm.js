import{w as A,a as se}from"./m78c574d5c3843a3d.js";import{I as V}from"./Icon.js";import{t as G,a as he,i as be}from"./index.js";import{p as ye,q as $e,r as ke,s as we,t as Ce,g as Se,u as Pe,v as Be,w as De,x as Ee,y as Ie,z as Ae,A as Ne,o as Ve}from"./m6cd080c8112b9076.js";import{s as Me}from"./m21bbc25c9f3922b4.js";import{B as Q,p as ze,b as Le,c as _e}from"./StringInput.js";import{D as Oe}from"./m3fc8d974e5d8216d.js";import{d as j,k as r,l as _,q as P,C as x,D as le,u as h,w as ee,c as U,o as ne,f as Re,E as Fe,y as Z,r as q,v as w,z as re,A as ue,s as p,p as v,F as L,g as de,a as I,t as W,B as Ue,n as oe}from"./mc55b2a42316522d6.js";import{J as je,x as N,K as F}from"./ma6cfd38af5d4c661.js";import{_ as T}from"./_plugin-vue_export-helper.js";import{r as S,u as y,v as Te}from"./m6bdda40d8bd2cf5a.js";import{M as Ke}from"./Modal.js";const We=j({inheritAttrs:!1,__name:"Wrapper",props:{tag:{type:[String,Boolean],default:!1}},setup(e){return(i,u)=>i.tag?(r(),_(le(i.tag),je(x({key:0},i.$attrs)),{default:P(()=>[h(i.$slots,"default")]),_:3},16)):h(i.$slots,"default",{key:1})}}),qe=T(We,[["__file","Wrapper.vue"]]),He=e=>(re("data-v-c3554bd5"),e=e(),ue(),e),Je=He(()=>p("span",{class:"visually-hidden"},"Toggle Dropdown",-1)),Ge=j({inheritAttrs:!1,__name:"Dropdown",props:{title:{default:""},split:{type:Boolean,default:!1},center:{type:Boolean,default:!1},direction:{default:"down"},alignment:{default:"start"},smStart:{type:Boolean,default:!1},mdStart:{type:Boolean,default:!1},lgStart:{type:Boolean,default:!1},xlStart:{type:Boolean,default:!1},xxlStart:{type:Boolean,default:!1},smEnd:{type:Boolean,default:!1},mdEnd:{type:Boolean,default:!1},lgEnd:{type:Boolean,default:!1},xlEnd:{type:Boolean,default:!1},xxlEnd:{type:Boolean,default:!1},autoClose:{type:[Boolean,String],default:!1},offset:{default:()=>[0,2]},menuOptions:{default:()=>({})},div:{type:Boolean,default:!1},flat:{type:Boolean,default:!1},noArrow:{type:Boolean,default:!1}},emits:["close","closed","prevented","open","opened"],setup(e,{expose:i,emit:u}){const a=S(null),o=S(null);ee(()=>a,t=>{t&&b()},{deep:!0});const l=t=>{u("close",t)},k=t=>{u("closed",t)},$=t=>{u("open",t)},C=t=>{u("opened",t)},b=()=>{o.value=new Oe(a.value,{autoClose:e.autoClose,offset:e.offset}),a.value.addEventListener("hide.bs.dropdown",l),a.value.addEventListener("hidden.bs.dropdown",k),a.value.addEventListener("show.bs.dropdown",$),a.value.addEventListener("shown.bs.dropdown",C)},B=()=>{var t,m;(m=(t=o.value)==null?void 0:t.show)==null||m.call(t)},g=()=>{var t,m;(m=(t=o.value)==null?void 0:t.hide)==null||m.call(t)},f=()=>{var t,m;a.value.removeEventListener("hide.bs.dropdown",l),a.value.removeEventListener("hidden.bs.dropdown",k),a.value.removeEventListener("show.bs.dropdown",$),a.value.removeEventListener("shown.bs.dropdown",C),(m=(t=o.value)==null?void 0:t.dispose)==null||m.call(t)};i({open:B,close:g,dispose:f,update:()=>{var t,m;(m=(t=o.value)==null?void 0:t.update)==null||m.call(t)},tagName:()=>e.div?"div":"ul"});const E=U(()=>({"dropdown-menu":!0,[`dropdown-menu-${e.alignment}`]:!0,...e.smStart?{"dropdown-menu-sm-start":!0}:{},...e.mdStart?{"dropdown-menu-md-start":!0}:{},...e.lgStart?{"dropdown-menu-lg-start":!0}:{},...e.xlStart?{"dropdown-menu-xl-start":!0}:{},...e.xxlStart?{"dropdown-menu-xxl-start":!0}:{},...e.smEnd?{"dropdown-menu-sm-end":!0}:{},...e.mdEnd?{"dropdown-menu-md-end":!0}:{},...e.lgEnd?{"dropdown-menu-lg-end":!0}:{},...e.xlEnd?{"dropdown-menu-xl-end":!0}:{},...e.xxlEnd?{"dropdown-menu-xxl-end":!0}:{}}));return ne(()=>{}),Re(()=>{f()}),(t,m)=>{const M=Fe("binds");return r(),_(qe,{tag:t.flat?"div":!1,class:N({"btn-group":!0,[`drop${t.direction}${t.center?"-center":""}`]:!0})},{default:P(()=>[Z((r(),_(Q,{class:N({"dropdown-toggle":!t.split,"no-arrow":t.noArrow}),"data-bs-toggle":t.split?!1:"dropdown","aria-expanded":"false",onClick:B,ref:z=>{t.split||(a.value=z.element())}},{default:P(()=>[h(t.$slots,"button",{},()=>[q(F(t.title),1)],!0)]),_:3},8,["class","data-bs-toggle"])),[[M,t.$attrs]]),t.split?Z((r(),_(Q,{key:0,class:N(["dropdown-toggle dropdown-toggle-split",{"no-arrow":t.noArrow}]),"data-bs-toggle":"dropdown","aria-expanded":"false",onClick:B,ref:z=>{t.split||(a.value=z.element())}},{default:P(()=>[Je]),_:1},8,["class"])),[[M,t.$attrs]]):w("",!0),Z((r(),_(le(t.div?"div":"ul"),{class:N(E.value)},{default:P(()=>[h(t.$slots,"default",{},void 0,!0)]),_:3},8,["class"])),[[M,t.menuOptions]])]),_:3},8,["tag","class"])}}});const ie=T(Ge,[["__scopeId","data-v-c3554bd5"],["__file","Dropdown.vue"]]),Qe={key:0},Xe=j({inheritAttrs:!1,__name:"DropdownItem",setup(e){const i=de(),u=U(()=>{var a,o,l,k,$,C,b,B;return((B=(b=(C=($=(k=(l=(o=(a=i==null?void 0:i.parent)==null?void 0:a.subTree)==null?void 0:o.children)==null?void 0:l[2])==null?void 0:k.type)==null?void 0:$.toString)==null?void 0:C.call($))==null?void 0:b.toLowerCase)==null?void 0:B.call(b))??null});return(a,o)=>(r(),v(L,null,[u.value==="ul"?(r(),v("li",Qe,[p("a",x({class:"dropdown-item",href:"#"},a.$attrs,{onClick:o[0]||(o[0]=A(()=>{},["prevent"]))}),[h(a.$slots,"default")],16)])):w("",!0),u.value==="div"?(r(),v("a",x({key:1,class:"dropdown-item",href:"#"},a.$attrs,{onClick:o[1]||(o[1]=A(()=>{},["prevent"]))}),[h(a.$slots,"default")],16)):w("",!0)],64))}}),Ye=T(Xe,[["__file","DropdownItem.vue"]]),Ze={class:"pagination-component"},xe={key:0,class:"count"},et={key:1,"aria-label":"Page navigation",class:"pages"},tt={class:"pagination pagination-sm"},at={key:0,class:"page-link"},st=["onClick"],ot={class:"per-page"},lt=j({__name:"Pagination",props:{page:{default:1},perPage:{default:10},total:{default:0},pages:{},buttons:{default:5},sizes:{default:()=>[5,10,25,50]}},emits:["update:page","update:perPage","update:total","update:buttons","change"],setup(e,{expose:i,emit:u}){const a=S(e.page),o=S(e.page),l=S(e.perPage),k=U(()=>Math.ceil(e.total/l.value)),$=U(()=>ze(a.value,e.perPage,e.total,e.buttons)),C=S(null);ee([a,l],()=>{u("update:page",a),u("update:perPage",l),u("update:total",e.total),u("update:buttons",e.buttons),u("change",{page:a,perPage:l,total:e.total,pages:k.value,buttons:e.buttons})},{deep:!0}),ee(l,()=>{a.value=1});const b=d=>{a.value=d},B=()=>{o.value++,o.value>k.value&&(o.value=1)},g=()=>{o.value--,o.value<1&&(o.value=k.value)},f=d=>{l.value=d,C.close()};return i({goTo:b,increment:B,decrement:g,changeSize:f}),(d,E)=>(r(),v("div",Ze,[d.total>0?(r(),v("div",xe,F(y(G)(":?-:? of :? rows",d.perPage*a.value-(d.perPage-1),d.perPage*a.value<=d.total?d.perPage*a.value:d.total,d.total)),1)):w("",!0),$.value.length>1?(r(),v("nav",et,[p("ul",tt,[p("li",{class:N(["page-item",{disabled:a.value===1}])},[p("a",{class:"page-link",href:"#",tabindex:"-1","aria-disabled":"true",onClick:E[0]||(E[0]=A(t=>b(1),["prevent"]))},[I(V,{path:y(ye)},null,8,["path"])])],2),p("li",{class:N(["page-item",{disabled:a.value===1}])},[p("a",{class:"page-link",href:"#",tabindex:"-1","aria-disabled":"true",onClick:E[1]||(E[1]=A(t=>b(a.value-1),["prevent"]))},[I(V,{path:y($e)},null,8,["path"])])],2),(r(!0),v(L,null,W($.value,t=>(r(),v("li",{class:N(["page-item",{active:t===a.value}]),key:t},[t===a.value?(r(),v("span",at,F(t),1)):(r(),v("a",{key:1,class:"page-link",href:"#",onClick:A(m=>b(t),["prevent"])},F(t),9,st))],2))),128)),p("li",{class:N(["page-item",{disabled:a.value===k.value}])},[p("a",{class:"page-link",href:"#",onClick:E[2]||(E[2]=A(t=>b(a.value+1),["prevent"]))},[I(V,{path:y(ke)},null,8,["path"])])],2),p("li",{class:N(["page-item",{disabled:a.value===k.value}])},[p("a",{class:"page-link",href:"#",tabindex:"-1","aria-disabled":"true",onClick:E[3]||(E[3]=A(t=>b(k.value),["prevent"]))},[I(V,{path:y(we)},null,8,["path"])])],2)])])):w("",!0),p("div",ot,[d.total>0?(r(),_(ie,{key:0,ref_key:"dropDown",ref:C,title:`${d.perPage} ${y(G)("rows")}`,"auto-close":""},{default:P(()=>[(r(!0),v(L,null,W(d.sizes,(t,m)=>(r(),v(L,{key:t},[m===0||(d.sizes.at(m-1)??0)<=d.total?(r(),_(Ye,{key:0,onClick:A(M=>f(t),["prevent"])},{default:P(()=>[q(F(t)+" "+F(y(G)("rows")),1)]),_:2},1032,["onClick"])):w("",!0)],64))),128))]),_:1},8,["title"])):w("",!0)])]))}});const nt=T(lt,[["__scopeId","data-v-36b0b856"],["__file","Pagination.vue"]]),rt={class:"input-group search-input-group"},ut=["placeholder","value","onKeydown"],dt=["onClick"],it=j({__name:"Search",props:{modelValue:{}},emits:["update:modelValue","clear","search"],setup(e,{emit:i}){const u=l=>{i("update:modelValue",l.target.value.trim())},a=()=>{i("clear")},o=()=>{i("search")};return(l,k)=>(r(),v("div",rt,[l.$slots["start-search"]?h(l.$slots,"start-search",{key:0}):w("",!0),l.modelValue!==""?(r(),v("button",{key:1,type:"button",class:"btn btn-primary",onClick:a},[I(V,{path:y(Ce)},null,8,["path"])])):w("",!0),l.$slots["before-search"]?h(l.$slots,"before-search",{key:2}):w("",!0),p("input",{type:"text",class:"form-control",placeholder:y(G)("Search..."),value:l.modelValue,onInput:k[0]||(k[0]=$=>u($)),onKeydown:[se(A(o,["stop"]),["enter"]),se(A(a,["stop"]),["esc"])]},null,40,ut),l.$slots["after-search"]?h(l.$slots,"after-search",{key:3}):w("",!0),p("button",{type:"button",class:"btn btn-primary",onClick:A(o,["prevent"])},[I(V,{path:y(Se)},null,8,["path"])],8,dt),l.$slots["end-search"]?h(l.$slots,"end-search",{key:4}):w("",!0)]))}}),pt=T(it,[["__file","Search.vue"]]),ct=e=>(re("data-v-dc41d7ed"),e=e(),ue(),e),vt={class:"row"},ft={class:"col-md-5"},mt={class:"d-flex flex-horizontal gap-3"},gt={class:"col-md-7"},ht={class:"d-flex gap-2 justify-content-end align-items-center h-100"},bt={class:"table-responsive"},yt={key:0,class:"fitable no-select"},$t=ct(()=>p("th",{class:"fitable no-select"},"#",-1)),kt=["onClick"],wt=["colspan"],Ct={key:0,class:"fitable no-select align-middle"},St={class:"fitable no-select align-middle"},Pt={key:1,class:"fitable no-select align-middle"},Bt={class:"d-flex gap-2 align-items-start"},Dt={key:2,class:"fitable no-select align-middle"},Et={key:0},It=["colspan"],At=j({__name:"Crud",props:{fields:{},fetch:{type:Function},keyName:{default:"id"}},emits:["empty","noEmpty"],setup(e,{expose:i,emit:u}){const a=U(()=>e.fields),o=de(),l=he(),{isDarkTheme:k}=Me(l),$=Te([]),C=S(1),b=S(5),B=S(""),g=S(e.keyName),f=S(!0),d=S(0),E=S(0),t=S(5),m=S({}),M=S(null),z=S(0),O=async()=>{var s,D,n,R;(D=(s=M.value)==null?void 0:s.start)==null||D.call(s);try{const c=await e.fetch({page:C.value,perPage:b.value,keyword:B.value,sort:`${f.value?"":"-"}${g.value}`.trim(),fields:a.value});$.value=c.data,d.value=(c==null?void 0:c.total)??0,C.value=(c==null?void 0:c.page)??1,b.value=(c==null?void 0:c.perPage)??1,E.value=(c==null?void 0:c.pages)??0,m.value={},$.value.length>0?u("noEmpty"):u("empty"),z.value++}catch{}(R=(n=M.value)==null?void 0:n.stop)==null||R.call(n)},K=async s=>{s.sortable&&(g.value=s.name,f.value=!f.value,O())},H=s=>{C.value=s.page.value,b.value=s.perPage.value,O()},pe=()=>{C.value=1,O()},ce=()=>{C.value=1,B.value="",O()},ae=()=>{O()},X=s=>s.visible===void 0||s.visible,ve=U(()=>{var s,D,n,R,c,J;return e.fields.filter(ge=>X(ge)).length+1+((D=(s=o==null?void 0:o.proxy)==null?void 0:s.$slots)!=null&&D.actions?1:0)+((R=(n=o==null?void 0:o.proxy)==null?void 0:n.$slots)!=null&&R.moreActions?1:0)+((J=(c=o==null?void 0:o.proxy)==null?void 0:c.$slots)!=null&&J.details?1:0)}),fe=s=>{m.value={...m.value,[s[e.keyName]]:!Y(s)}},Y=s=>Object.hasOwn(m.value,s[e.keyName])&&m.value[s[e.keyName]],me=U(()=>{var s;return((s=$.value)==null?void 0:s.length)??0});return ne(()=>{O()}),i({refresh:ae,length:()=>me.value,data:()=>$.value}),(s,D)=>(r(),v("div",{class:"crud-component",key:`crud-${z.value}`},[h(s.$slots,"start",{},void 0,!0),p("div",vt,[p("div",ft,[p("div",mt,[I(Q,{color:"primary",onClick:ae,ref_key:"refresher",ref:M,"spinner-small":"","spinner-color":"light",style:{"min-width":"50px"}},{default:P(()=>[I(V,{path:y(Pe)},null,8,["path"])]),_:1},512),I(pt,{modelValue:B.value,"onUpdate:modelValue":D[0]||(D[0]=n=>B.value=n),onClear:ce,onSearch:pe},Ue({_:2},[s.$slots["start-search"]?{name:"start-search",fn:P(()=>[h(s.$slots,"start-search",{},void 0,!0)]),key:"0"}:void 0,s.$slots["before-search"]?{name:"before-search",fn:P(()=>[h(s.$slots,"before-search",{},void 0,!0)]),key:"1"}:void 0,s.$slots["after-search"]?{name:"after-search",fn:P(()=>[h(s.$slots,"after-search",{},void 0,!0)]),key:"2"}:void 0,s.$slots["end-search"]?{name:"end-search",fn:P(()=>[h(s.$slots,"end-search",{},void 0,!0)]),key:"3"}:void 0]),1032,["modelValue"])])]),p("div",gt,[p("div",ht,[h(s.$slots,"topActions",{},void 0,!0)])])]),h(s.$slots,"before",{},void 0,!0),p("div",bt,[p("table",{class:N(["table table-bordered table-striped table-hover m-0",{"table-dark":y(k)}])},[p("thead",null,[p("tr",null,[s.$slots.details?(r(),v("th",yt," ")):w("",!0),$t,(r(!0),v(L,null,W(a.value,(n,R)=>(r(),v(L,{key:`${n.name}-${R}`},[X(n)?(r(),v("th",{key:0,class:N({fitable:n.fitable,"no-select":!0,pointer:n.sortable,"table-active":n.sortable&&g.value===n.name})},[p("div",{class:"d-flex gap-2",onClick:A(c=>K(n),["prevent","stop"])},[p("span",null,[h(s.$slots,`${n.name}Header`,{field:n},()=>[q(F(n.label),1)],!0)]),n.sortable&&g.value===n.name?(r(),_(V,{key:0,path:f.value?y(Be):y(De),class:N({"ms-auto":!0}),color:y(be)()?"info":"primary"},null,8,["path","color"])):(r(),_(V,{key:1,path:y(Ee),class:"ms-auto text-muted"},null,8,["path"]))],8,kt)],2)):w("",!0)],64))),128)),s.$slots.moreActions||s.$slots.actions?(r(),v("th",{key:1,colspan:s.$slots.moreActions&&s.$slots.actions?2:1,class:"fitable no-select"}," Actions ",8,wt)):w("",!0)])]),p("tbody",null,[(r(!0),v(L,null,W($.value,(n,R)=>(r(),v(L,{key:n[s.keyName]},[p("tr",null,[s.$slots.details?(r(),v("td",Ct,[I(V,{path:Y(n)?y(Ie):y(Ae),onClick:c=>fe(n),class:"pointer"},null,8,["path","onClick"])])):w("",!0),p("td",St,F(R+1),1),(r(!0),v(L,null,W(a.value,(c,J)=>(r(),v(L,{key:`${c.name}-${J}`},[X(c)?(r(),v("td",{key:0,class:N({fitable:c.fitable,"select-all":!0,"table-active":c.sortable&&g.value===c.name,border:c.sortable&&g.value===c.name,"align-middle":!0})},[h(s.$slots,`${c.name}Value`,{field:c,item:n},()=>[q(F(n[c.name]),1)],!0)],2)):w("",!0)],64))),128)),s.$slots.actions?(r(),v("td",Pt,[p("div",Bt,[h(s.$slots,"actions",{item:n},void 0,!0)])])):w("",!0),s.$slots.moreActions?(r(),v("td",Dt,[I(ie,{"no-arrow":"",div:""},{button:P(()=>[I(V,{path:y(Ne)},null,8,["path"])]),default:P(()=>[h(s.$slots,"moreActions",{item:n},void 0,!0)]),_:2},1024)])):w("",!0)]),s.$slots.details&&Y(n)?(r(),v("tr",Et,[p("td",{colspan:ve.value,class:"p-0 align-middle"},[h(s.$slots,"details",{item:n},void 0,!0)],8,It)])):w("",!0)],64))),128))])],2)]),h(s.$slots,"after",{},void 0,!0),I(nt,{page:C.value,"onUpdate:page":D[1]||(D[1]=n=>C.value=n),"per-page":b.value,"onUpdate:perPage":D[2]||(D[2]=n=>b.value=n),total:d.value,"onUpdate:total":D[3]||(D[3]=n=>d.value=n),buttons:t.value,"onUpdate:buttons":D[4]||(D[4]=n=>t.value=n),onChange:H},null,8,["page","per-page","total","buttons"]),h(s.$slots,"end",{},void 0,!0)]))}});const Jt=T(At,[["__scopeId","data-v-dc41d7ed"],["__file","Crud.vue"]]);function te(e,i=null){const u=[];let a;for(a in e)if(e.hasOwnProperty(a)){const o=i?`${i}[${a}]`:a,l=e[a];u.push(l!==null&&typeof l=="object"?te(l,o):`${encodeURIComponent(o)}=${encodeURIComponent(l)}`)}return u.join("&")}var Nt=(e=>(e.Number="number",e.String="string",e.Enum="enum",e))(Nt||{});const Vt=({data:e,header:i})=>({data:e,total:parseInt(i("x-pagination-total-count"))??0,page:parseInt(i("x-pagination-current-page"))??1,perPage:parseInt(i("x-pagination-per-page"))??1,pages:parseInt(i("x-pagination-page-count"))??0}),Mt=(e,i)=>{if(e){let u=[];for(const a of i)if(a.searchable){const o={};a.type==="number"&&/^\d+\.{0,1}\d{0,}$/.test(e)?o[a.name]=e:(a.type==="string"||a.type==="enum")&&(o[a.name]={like:e}),Object.keys(o).length>0&&u.push(o)}return u={or:u},te(u,"filter")}return""},Gt=(e,i,u)=>({page:a,perPage:o,sort:l,keyword:k,fields:$})=>new Promise((C,b)=>{const B=()=>{if(u&&Object.keys(u).length>0){let f=[];for(let d in u)typeof u[d]=="object"?f.push(te(u[d],d)):f.push(`${d}=${u[d]}`);return`&${f.join("&")}`}return""},g=Mt(k,$);Le().get(`${e}?${i?`expand=${i}&`:""}page=${a}&per-page=${o}&sort=${l}${g?`&${g}`:""}${B()}`).then(f=>{C(Vt(f))}).catch(f=>{b(f)})}),Qt=(...e)=>[...e],zt=j({inheritAttrs:!1,__name:"ModalForm",props:{modelClass:{type:Function},name:{},size:{default:null},fullscreen:{type:[Boolean,String],default:!1}},emits:["save"],setup(e,{expose:i,emit:u}){const a=S(null),o=S(null),[l,k,$]=_e(e.modelClass),C=g=>{k({...g??{}}),oe(()=>{var f,d;(d=(f=a.value)==null?void 0:f.open)==null||d.call(f)})},b=()=>{var g,f,d,E;(E=(d=(f=(g=l.value)==null?void 0:g.validate)==null?void 0:f.call(g))==null?void 0:d.then)==null||E.call(d,t=>{var m,M;t&&l.value&&((M=(m=o.value)==null?void 0:m.start)==null||M.call(m),u("save",l.value,()=>{var z,O;(O=(z=o.value)==null?void 0:z.stop)==null||O.call(z),oe(()=>{var K,H;(H=(K=a.value)==null?void 0:K.close)==null||H.call(K)})}))})},B=()=>{$()};return i({open:C}),(g,f)=>y(l)?(r(),_(Ke,{key:0,ref_key:"modal",ref:a,tag:"form",title:`${y(l).isNewRecord?"Add New":"Edit"} ${g.name}`,size:g.size,fullscreen:g.fullscreen,onSubmit:A(b,["prevent"]),onClosed:B},{header:P(()=>[h(g.$slots,"header")]),buttons:P(()=>[I(Q,{type:"submit",ref_key:"button",ref:o,color:"primary","spinner-color":"info",style:{height:"42px"}},{default:P(()=>[I(V,{path:y(Ve),color:"info"},null,8,["path"]),q("Save ")]),_:1},512)]),default:P(()=>[h(g.$slots,"default",{model:y(l)})]),_:3},8,["title","size","fullscreen","onSubmit"])):w("",!0)}}),Xt=T(zt,[["__file","ModalForm.vue"]]);export{Jt as C,Nt as F,Xt as M,Qt as c,Gt as f};
//# sourceMappingURL=ModalForm.js.map

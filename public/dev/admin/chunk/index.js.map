{"version":3,"file":"index.js","sources":["../../../../resources/js/lib/metadata.ts","../../../../resources/js/lib/helper/cookies.ts","../../../../resources/js/modules/theme/index.ts"],"sourcesContent":["let _initData: any = null;\r\n\r\nexport type Url = {\r\n  api: string;\r\n  self: string;\r\n  base: {\r\n    absolute: string;\r\n    relative: string;\r\n  };\r\n};\r\n\r\nexport type Cms = {\r\n  type: { name: string; label: string }[];\r\n  category: any;\r\n  content: any;\r\n};\r\n\r\nexport type SettingsItem = {\r\n  type: string;\r\n  key?: string;\r\n  name: string;\r\n  label: string;\r\n  icon?: string;\r\n  defaultValue?: any;\r\n  attributes?: { [name: string]: any };\r\n  props?: { [name: string]: any };\r\n};\r\n\r\nexport type SettingsCategory = {\r\n  name: string;\r\n  label: string;\r\n  items: Array<SettingsItem>;\r\n};\r\n\r\nexport type Settings = Array<SettingsCategory>;\r\n\r\nexport type Language = {\r\n  value: string;\r\n  label: string;\r\n};\r\n\r\nexport type Metadata = {\r\n  env?: string;\r\n  id?: string;\r\n  name?: string;\r\n  language?: string;\r\n  languages?: Language[];\r\n  tier?: string;\r\n  token?: null | string;\r\n  user?: null | any;\r\n  isAuth?: boolean;\r\n  isGuest?: boolean;\r\n  translations?: { [msg: string]: string };\r\n  permissions?: any;\r\n  url?: Url;\r\n  isMobile?: boolean;\r\n  isTablet?: boolean;\r\n  isDesktop?: boolean;\r\n  cms?: Cms;\r\n  settings?: Settings;\r\n  balancesGroups?: string[][];\r\n  currenciesSort?: string[];\r\n};\r\n\r\nfunction decodeData(): any {\r\n  if (!_initData) {\r\n    const z = Math.pow(2, 3) + 2;\r\n    const t = Math.pow(2, 1);\r\n    const m = z * t * 5 + Math.pow(10, 2);\r\n    const n = [78, 80, 101, 82, 102, 90, 91]\r\n      .map((x) => String.fromCharCode(m - x))\r\n      .join(\"\");\r\n    const d = window;\r\n    const q = d[n];\r\n    const res = JSON.parse(\r\n      window.atob(\r\n        q\r\n          .map((value: any, i: any) =>\r\n            i > 0 ? String.fromCharCode(q.slice(0, 1).shift() - value) : null\r\n          )\r\n          .filter((x: any) => x !== null)\r\n          .join(\"\")\r\n      )\r\n    );\r\n    _initData = res;\r\n  }\r\n  return _initData;\r\n}\r\n\r\nlet _meta: null | Metadata = null;\r\n\r\nexport function metadata(): null | Metadata {\r\n  if (!_meta) {\r\n    _meta = decodeData();\r\n  }\r\n  return _meta;\r\n}\r\n\r\nlet _translations: any = null;\r\n\r\nexport function translate(message: string, ...params: any): string {\r\n  if (!_translations) {\r\n    _translations = metadata()?.translations;\r\n  }\r\n  if (_translations) {\r\n    message = _translations?.[message] ?? message;\r\n\r\n    if (Array.isArray(params)) {\r\n      params.forEach((item) => {\r\n        message = message.replace(\":?\", item);\r\n      });\r\n    }\r\n  }\r\n  return message;\r\n}\r\n\r\nexport function user(): null | any {\r\n  return metadata()?.user ?? null;\r\n}\r\n\r\nexport function token(): null | string {\r\n  return metadata()?.token ?? null;\r\n}\r\n\r\nlet _permissions: any = null;\r\n\r\nexport function can(permission: any): boolean {\r\n  if ([\"developer\", \"master\"].includes(user()?.type)) {\r\n    return true;\r\n  }\r\n\r\n  if (!_permissions) {\r\n    _permissions = metadata()?.permissions;\r\n  }\r\n\r\n  let permitted = false;\r\n  if (_permissions) {\r\n    permission.split(\"|\").forEach((perm: string) => {\r\n      permitted = permitted || _permissions.hasOwnProperty(perm);\r\n    });\r\n  }\r\n  return permitted;\r\n}\r\n\r\nexport function language(): string {\r\n  return metadata()?.language ?? \"en\";\r\n}\r\n\r\nexport function languages(): Language[] {\r\n  return metadata()?.languages ?? [];\r\n}\r\n\r\nexport function cms(): Cms | null {\r\n  return metadata()?.cms ?? null;\r\n}\r\n\r\nexport function settings(): Settings | null {\r\n  return metadata()?.settings ?? null;\r\n}\r\n","export function getCookie(name): any {\r\n  var v = document.cookie.match(\"(^|;) ?\" + name + \"=([^;]*)(;|$)\");\r\n  return v ? v[2] : null;\r\n}\r\n\r\nexport function setCookie(name, value, days): void {\r\n  var d = new Date();\r\n  d.setTime(d.getTime() + 24 * 60 * 60 * 1000 * days);\r\n  document.cookie = name + \"=\" + value + \";path=/;expires=\" + d.toString();\r\n}\r\n\r\nexport function deleteCookie(name): void {\r\n  setCookie(name, \"\", -1);\r\n}\r\n","import { setCookie } from \"@/lib/helper/cookies\";\r\nimport { metadata } from \"@/lib/metadata\";\r\nimport { defineStore } from \"pinia\";\r\nimport { computed, nextTick, ref } from \"vue\";\r\n\r\nexport const THEME_LIGHT = 0;\r\nexport const THEME_DARK = 1;\r\nexport const THEME_AUTO = 2;\r\n\r\nexport const themes = [\"light\", \"dark\", \"auto\"];\r\n\r\nexport const getStoredTheme = () => localStorage.getItem(`theme-${metadata?.()?.tier}`);\r\nexport const setStoredTheme = (theme) => {\r\n  localStorage.setItem(`theme-${metadata?.()?.tier}`, theme);\r\n};\r\n\r\nexport const getPreferredTheme = () => {\r\n  const storedTheme = getStoredTheme();\r\n  if (storedTheme) {\r\n    return storedTheme;\r\n  }\r\n\r\n  return window.matchMedia(\"(prefers-color-scheme: dark)\").matches\r\n    ? \"dark\"\r\n    : \"light\";\r\n};\r\n\r\nexport const setTheme = (theme) => {\r\n  if (\r\n    theme === \"auto\" &&\r\n    window.matchMedia(\"(prefers-color-scheme: dark)\").matches\r\n  ) {\r\n    document.documentElement.setAttribute(\"data-bs-theme\", \"dark\");\r\n    setCookie(`theme-${metadata?.()?.tier}`, \"dark\", 73200);\r\n  } else {\r\n    document.documentElement.setAttribute(\"data-bs-theme\", theme);\r\n    setCookie(`theme-${metadata?.()?.tier}`, theme, 73200);\r\n  }\r\n};\r\n\r\nexport const initTheme = () => {\r\n  setTheme(getPreferredTheme());\r\n};\r\n\r\nexport const useThemeStore = defineStore(\"theme\", () => {\r\n  const themeInc = ref<number>(\r\n    getPreferredTheme() === \"dark\"\r\n      ? THEME_DARK\r\n      : getPreferredTheme() === \"light\"\r\n      ? THEME_LIGHT\r\n      : THEME_AUTO\r\n  );\r\n\r\n  const theme = computed(() => {\r\n    return themes[themeInc.value % 3];\r\n  });\r\n\r\n  const isDarkTheme = computed(() => {\r\n    return (\r\n      theme.value === \"dark\" ||\r\n      (window.matchMedia(\"(prefers-color-scheme: dark)\").matches &&\r\n        theme.value === \"auto\")\r\n    );\r\n  });\r\n\r\n  const changeTheme = () => {\r\n    themeInc.value++;\r\n    nextTick(() => {\r\n      setStoredTheme(theme.value);\r\n      setTheme(theme.value);\r\n    });\r\n  };\r\n  return { theme, isDarkTheme, changeTheme };\r\n});\r\n\r\nexport function isDark() {\r\n  const themeStore = useThemeStore();\r\n  return themeStore.isDarkTheme;\r\n}\r\n\r\nwindow\r\n  .matchMedia(\"(prefers-color-scheme: dark)\")\r\n  .addEventListener(\"change\", () => {\r\n    const storedTheme = getStoredTheme();\r\n    if (storedTheme !== \"light\" && storedTheme !== \"dark\") {\r\n      setTheme(getPreferredTheme());\r\n    }\r\n  });\r\n"],"names":["_initData","decodeData","z","m","n","x","q","value","i","_meta","metadata","_translations","translate","message","params","_a","item","user","languages","cms","settings","setCookie","name","days","d","THEME_LIGHT","THEME_DARK","THEME_AUTO","themes","getStoredTheme","setStoredTheme","theme","getPreferredTheme","storedTheme","setTheme","_b","initTheme","useThemeStore","defineStore","themeInc","ref","computed","isDarkTheme","nextTick","isDark"],"mappings":"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"}
var at=Object.defineProperty;var lt=(r,s,a)=>s in r?at(r,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[s]=a;var E=(r,s,a)=>(lt(r,typeof s!="symbol"?s+"":s,a),a);import{B as N,S as ot,M as nt,b as Q,s as j}from"./StringInput.js";import{a as it,n as ct}from"./strings.js";import{l as G}from"./index.js";import{d as W,c as A,k as p,p as T,u as dt,C as ut,a as b,q as d,s as w,l as D,r as x,v as V,F as J,t as ft}from"./mc55b2a42316522d6.js";import{_ as X}from"./_plugin-vue_export-helper.js";import{c as pt,F as C,f as ht,C as gt,M as yt}from"./ModalForm.js";import{T as R}from"./TextInput.js";import{I as U}from"./Icon.js";import{m as bt,a as vt}from"./m6cd080c8112b9076.js";import{r as B,u as _}from"./m6bdda40d8bd2cf5a.js";import{K as F}from"./ma6cfd38af5d4c661.js";class _t{constructor(s){E(this,"_action",()=>{});E(this,"_events",{});this.count=s}set action(s){this._action=s}get action(){return this._action}on(s,a){this._events.hasOwnProperty(s)||(this._events[s]=[]),this._events[s].push(a)}dispatch(s,a=null){if(this._events.hasOwnProperty(s))for(const k of this._events[s])k(new CustomEvent(s,{bubbles:!0,detail:{target:this,data:a}}))}start(){this.dispatch("start"),Y(this)}}function Y(r,s=0){kt(r,s),r.count>s?r.action(s,()=>{Y(r,s+1)}):r.dispatch("done")}function kt(r,s){let a=Math.ceil(s*100/r.count);a>100&&(a=100),r.dispatch("progress",{current:s,total:r.count,percentage:a})}function mt(r){return new _t(r)}const St=W({__name:"Badge",props:{color:{default:"primary"},bgColor:{default:null},pill:{type:Boolean,default:!1}},setup(r){const s=A(()=>{const a={badge:!0};return r.bgColor?(a[`text-${r.color}`]=!0,a[`bg-${r.bgColor}`]=!0):a[`text-bg-${r.color}`]=!0,r.pill&&(a["rounded-pill"]=!0),a});return(a,k)=>(p(),T("span",ut({class:s.value},a.$attrs),[dt(a.$slots,"default")],16))}}),P=X(St,[["__file","Badge.vue"]]),wt=["innerHTML"],xt={class:"d-flex flex-horizontal gap-2"},Ct={key:0,class:"d-flex flex-horizontal gap-2"},Tt=["innerHTML"],$t={class:"mb-3"},Dt={class:"mb-3"},Bt={class:"mb-3"},Mt=W({__name:"Seo",props:{target:{}},setup(r){const s=pt({type:C.Number,name:"id",label:"ID",sortable:!0,searchable:!0,fitable:!0},{type:C.String,name:"title",label:"Title",sortable:!0,searchable:!0},{type:C.String,name:"description",label:"Description",sortable:!0,searchable:!0},{type:C.String,name:"keywords",label:"Keywords",sortable:!0,searchable:!0,fitable:!0},{type:C.String,name:"target",label:"Page",sortable:!0,searchable:!0,fitable:!0}),a=B(null),k=B(null),M=B(null),L=B(!1);class Z extends nt{get id(){var e;return this.field("id","ID",((e=this.initData)==null?void 0:e.id)??null)}get target(){var e;return this.field("target","Target",((e=this.initData)==null?void 0:e.target)??null)}get title(){var e;return this.field("title","Title",((e=this.initData)==null?void 0:e.title)??"")}get description(){var e;return this.field("description","Description",((e=this.initData)==null?void 0:e.description)??"")}get keywords(){var e;return this.field("keywords","Keywords",((e=this.initData)==null?void 0:e.keywords)??[],"Separate keywords by comma")}get rules(){return[]}}const H=o=>{L.value=o},q=()=>{var l,h,i,g,v;(h=(l=M.value)==null?void 0:l.start)==null||h.call(l);const o=(v=(g=(i=a.value)==null?void 0:i.data)==null?void 0:g.call(i))==null?void 0:v.map(n=>{var u;return(u=n.target)==null?void 0:u.split("-").at(1)}),e=G().filter(({value:n})=>!o.includes(n)),t=mt(e.length);t.action=(n,u)=>{var c,y;Q().post("/seo",{target:`${r.target}${(y=(c=e==null?void 0:e.at)==null?void 0:c.call(e,n))==null?void 0:y.value}`,keywords:[],description:"",title:`Seo Title ${new Date().getTime()}`}).then(()=>{u()})},t.on("done",()=>{var n,u,c,y;j("Seo Created Successfully"),(u=(n=a.value)==null?void 0:n.refresh)==null||u.call(n),(y=(c=M.value)==null?void 0:c.stop)==null||y.call(c)}),t.start()},tt=o=>{var t,l;const e={...o};e.keywords=e.keywords.join(`
`),(l=(t=k.value)==null?void 0:t.open)==null||l.call(t,e)},et=(o,e)=>{var l,h;const t=o.data;t.keywords=((h=(l=t.keywords)==null?void 0:l.split)==null?void 0:h.call(l,","))??[],Q().put(`/seo/${t.id}`,t).finally(()=>{var i,g;j("Seo Created Successfully"),(g=(i=a.value)==null?void 0:i.refresh)==null||g.call(i),e()})},st=A(()=>{if(r.target)return{filter:{target:{like:r.target}}}}),rt=A(()=>{var o,e,t;return((e=(o=a.value)==null?void 0:o.length)==null?void 0:e.call(o))<((t=G())==null?void 0:t.length)});return(o,e)=>(p(),T(J,null,[b(gt,{ref_key:"crud",ref:a,fields:_(s),fetch:_(ht)("/seo",void 0,st.value),onEmpty:e[0]||(e[0]=t=>H(!0)),onNoEmpty:e[1]||(e[1]=t=>H(!1))},{descriptionValue:d(({item:t})=>[w("div",{innerHTML:_(it)((t==null?void 0:t.description)??"")},null,8,wt)]),targetValue:d(({item:t})=>{var l,h,i,g,v,n,u,c,y,I;return[w("div",xt,[(u=(n=(v=(g=(i=(h=(l=t==null?void 0:t.target)==null?void 0:l.split)==null?void 0:h.call(l,"-"))==null?void 0:i[0])==null?void 0:g.toString())==null?void 0:v.split)==null?void 0:n.call(v,":"))!=null&&u[0]?(p(),D(P,{key:0,color:"primary"},{default:d(()=>{var f,m,S,K,$,O,z;return[x(F(((z=(O=($=(K=(S=(m=(f=t==null?void 0:t.target)==null?void 0:f.split)==null?void 0:m.call(f,"-"))==null?void 0:S[0])==null?void 0:K.toString())==null?void 0:$.split)==null?void 0:O.call($,":"))==null?void 0:z[0])??""),1)]}),_:2},1024)):V("",!0),(I=(y=(c=t==null?void 0:t.target)==null?void 0:c.split)==null?void 0:y.call(c,"-"))!=null&&I[1]?(p(),D(P,{key:1,color:"info"},{default:d(()=>{var f,m,S;return[x(F(((S=(m=(f=t==null?void 0:t.target)==null?void 0:f.split)==null?void 0:m.call(f,"-"))==null?void 0:S[1])??""),1)]}),_:2},1024)):V("",!0)])]}),keywordsValue:d(({item:t})=>[Array.isArray(t.keywords)&&t.keywords.length>0?(p(),T("div",Ct,[(p(!0),T(J,null,ft(t.keywords,l=>(p(),D(P,{key:l,color:"warning"},{default:d(()=>[x(F(l),1)]),_:2},1024))),128))])):(p(),T("div",{key:1,innerHTML:_(ct)()},null,8,Tt))]),actions:d(({item:t})=>[b(N,{color:"info",class:"text-light",onClick:l=>tt(t)},{default:d(()=>[b(U,{path:_(bt),color:"light"},null,8,["path"]),x("Edit ")]),_:2},1032,["onClick"])]),topActions:d(()=>[o.target&&(L.value||rt.value)?(p(),D(N,{key:0,ref_key:"adder",ref:M,color:"primary",class:"text-light",onClick:q},{default:d(()=>[b(U,{path:_(vt),color:"light"},null,8,["path"]),x("Add Seo ")]),_:1},512)):V("",!0)]),_:1},8,["fields","fetch"]),b(yt,{ref_key:"modal",ref:k,name:"SEO","model-class":Z,onSave:et},{default:d(({model:t})=>[w("div",$t,[b(ot,{field:t.title},null,8,["field"])]),w("div",Dt,[b(R,{field:t.description,style:{height:"200px"}},null,8,["field"])]),w("div",Bt,[b(R,{field:t.keywords,style:{height:"200px"}},null,8,["field"])])]),_:1},512)],64))}}),Qt=X(Mt,[["__file","Seo.vue"]]);export{Qt as S};
//# sourceMappingURL=Seo.js.map

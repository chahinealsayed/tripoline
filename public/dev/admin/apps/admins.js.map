{"version":3,"file":"admins.js","sources":["../../../../resources/js/modules/form/rules/compare.ts","../../../../resources/js/forms/user.ts","../../../../resources/js/tiers/admin/apps/Admins.vue","../../../../resources/js/tiers/admin/startup/Admins.ts"],"sourcesContent":["import { Rule } from \"../lib/rule\";\r\nimport { Field } from \"../lib/field\";\r\nimport { createPrivateField } from \"@/lib/private\";\r\n\r\ntype Validation<T> = (rule: T, comparedField: Field) => boolean;\r\n\r\nconst [comparedField, setComparedField] = createPrivateField<\r\n  CompareRule,\r\n  Field\r\n>();\r\n\r\nconst [validation, setValidation] = createPrivateField<\r\n  CompareRule,\r\n  Validation<CompareRule>\r\n>();\r\n\r\nexport class CompareRule extends Rule {\r\n  init() {\r\n    super.init();\r\n\r\n    setValidation(this, () => {\r\n      return (rule: this, comparedField: Field) =>\r\n        rule.field.value === comparedField.value;\r\n    });\r\n  }\r\n\r\n  compareWith(field: Field): this {\r\n    setComparedField(this, field);\r\n    return this;\r\n  }\r\n\r\n  validation(callback: (rule: this, comparedField: Field) => boolean) {\r\n    setValidation(this, () => callback);\r\n  }\r\n\r\n  get defaultMessage(): string {\r\n    return `{attribute} is not matched ${comparedField(this).label}`;\r\n  }\r\n  validate(): Promise<boolean> {\r\n    return new Promise((resolve) => {\r\n      resolve(!this.field.value || validation(this)(this, comparedField(this)));\r\n    });\r\n  }\r\n}\r\n","import { translate } from \"@/lib/metadata\"\r\nimport { Field } from \"@/modules/form/lib/field\"\r\nimport { Model } from \"@/modules/form/lib/model\"\r\nimport { CompareRule } from \"@/modules/form/rules/compare\"\r\nimport { RequiredRule } from \"@/modules/form/rules/required\"\r\nimport { StringRule } from \"@/modules/form/rules/string\"\r\n\r\nexport class User extends Model {\r\n\tget id(): Field {\r\n\t\treturn this.field(\"id\", translate(\"ID\"), this.initData?.id ?? \"\")\r\n\t}\r\n\r\n\tget username(): Field {\r\n\t\treturn this.field(\r\n\t\t\t\"username\",\r\n\t\t\ttranslate(\"Username\"),\r\n\t\t\tthis.initData?.username ?? \"\",\r\n\t\t)\r\n\t}\r\n\r\n\tget password(): Field {\r\n\t\treturn this.field(\"password\", translate(\"Password\"), \"\")\r\n\t}\r\n\r\n\tget confirmPassword(): Field {\r\n\t\treturn this.field(\"confirm_password\", translate(\"Confirm Password\"), \"\")\r\n\t}\r\n\r\n\tget status(): Field {\r\n\t\treturn this.field(\r\n\t\t\t\"status\",\r\n\t\t\ttranslate(\"Status\"),\r\n\t\t\tthis.initData?.status ?? \"enabled\",\r\n\t\t)\r\n\t}\r\n\r\n\tget rules(): any[] {\r\n\t\treturn [\r\n\t\t\t[\r\n\t\t\t\t[this.username, this.password, this.confirmPassword],\r\n\t\t\t\tStringRule,\r\n\t\t\t],\r\n\t\t\t[[this.username], RequiredRule],\r\n\t\t\t[\r\n\t\t\t\t[this.password, this.confirmPassword],\r\n\t\t\t\tRequiredRule,\r\n\t\t\t\t(required: RequiredRule) => required.enabled(() => this.isNewRecord),\r\n\t\t\t],\r\n\t\t\t[\r\n\t\t\t\t[this.confirmPassword],\r\n\t\t\t\tCompareRule,\r\n\t\t\t\t(compare: CompareRule) => compare.compareWith(this.password),\r\n\t\t\t],\r\n\t\t]\r\n\t}\r\n}\r\n","<script setup lang=\"ts\">\r\nimport { User } from \"@/forms/user\";\r\nimport { api } from \"@/lib/api\";\r\nimport { metadata, translate } from \"@/lib/metadata\";\r\nimport Button from \"@/modules/bootstrap/components/Button.vue\";\r\nimport Crud from \"@/modules/crud/components/Crud.vue\";\r\nimport { createFields, fetch } from \"@/modules/crud/lib/crud\";\r\nimport { Field } from \"@/modules/form/lib/field\";\r\nimport { Model } from \"@/modules/form/lib/model\";\r\nimport { RequiredRule } from \"@/modules/form/rules/required\";\r\nimport { StringRule } from \"@/modules/form/rules/string\";\r\nimport { DataList } from \"@/modules/form/types\";\r\nimport Icon from \"@/components/Icon.vue\";\r\nimport { mdiPencil, mdiPlusThick } from \"@mdi/js\";\r\nimport ModalForm from \"@/modules/form/components/helper/ModalForm.vue\";\r\nimport { ref } from \"vue\";\r\nimport StringInput from \"@/modules/form/components/StringInput.vue\";\r\nimport RadioInput from \"@/modules/form/components/RadioInput.vue\";\r\nimport { FieldType } from \"@/modules/crud/lib/crud\";\r\nimport { successToast } from '@/modules/bootstrap/lib/toast';\r\n\r\ntype Item = {\r\n  id?: number;\r\n  name?: string;\r\n  username?: string;\r\n  user: {\r\n    id?: number;\r\n    username?: string;\r\n    status?: \"enabled\" | \"disabled\" | \"pending\";\r\n  };\r\n};\r\n\r\nconst fields = createFields(\r\n  {\r\n    type: FieldType.Number,\r\n    name: \"id\",\r\n    label: \"ID\",\r\n    fitable: true,\r\n    sortable: true,\r\n    searchable: true,\r\n  },\r\n  {\r\n    type: FieldType.String,\r\n    name: \"name\",\r\n    label: \"Name\",\r\n    fitable: false,\r\n    sortable: true,\r\n    searchable: true,\r\n  },\r\n  {\r\n    type: FieldType.String,\r\n    name: \"username\",\r\n    label: \"Username\",\r\n    fitable: true,\r\n    sortable: true,\r\n    searchable: true,\r\n  },\r\n  {\r\n    type: FieldType.String,\r\n    name: \"status\",\r\n    label: \"Status\",\r\n    fitable: true,\r\n    sortable: true,\r\n    searchable: true,\r\n  }\r\n);\r\n\r\nclass Admin extends Model {\r\n  get id(): Field {\r\n    return this.field(\"id\", translate(\"ID\"), this.initData?.id ?? \"\");\r\n  }\r\n\r\n  get name(): Field {\r\n    return this.field(\"name\", translate(\"Name\"), this.initData?.name ?? \"\");\r\n  }\r\n\r\n  get user(): User {\r\n    return this.hasOne(\"user\", (initData: DataList) => new User(initData));\r\n  }\r\n\r\n  get rules(): any[] {\r\n    return [\r\n      [[this.name], StringRule],\r\n      [[this.name], RequiredRule],\r\n    ];\r\n  }\r\n}\r\n\r\nconst crud = ref<any>(null);\r\nconst modal = ref<any>(null);\r\n\r\nconst add = () => {\r\n  modal.value?.open?.();\r\n};\r\n\r\nconst edit = (data: Item) => {\r\n  modal.value?.open?.(data);\r\n};\r\n\r\nconst save = (model: Admin, done: () => void) => {\r\n  let request;\r\n  if (model.isNewRecord) {\r\n    request = api().post(\"/admins\", model.data);\r\n  } else {\r\n    request = api().put(`/admins/${model.id.value}`, model.data);\r\n  }\r\n  request.then(() => {\r\n    successToast(`${model.name.value}`, `Admin Saved Successfully`);\r\n    crud.value?.refresh();\r\n    done();\r\n  });\r\n};\r\n</script>\r\n<template>\r\n  <Crud ref=\"crud\" :fields=\"fields\" :fetch=\"fetch < Item > ('/admins', 'user')\">\r\n    <template #usernameValue=\"{ item }\">\r\n      {{ item.user?.username ?? \"--\" }}\r\n    </template>\r\n    <template #statusValue=\"{ item }\">\r\n      <span :class=\"{'text-success': item.user?.status === 'enabled'}\">{{ item.user?.status }}</span>\r\n    </template>\r\n    <template #actions=\"{ item }\">\r\n      <Button color=\"info\" size=\"sm\" @click=\"edit(item)\">\r\n        <Icon :path=\"mdiPencil\" color=\"light\" />\r\n        <span class=\"text-light\">Edit</span>\r\n      </Button>\r\n    </template>\r\n    <template #topActions>\r\n      <Button color=\"primary\" @click=\"add\">\r\n        <Icon :path=\"mdiPlusThick\" color=\"light\" /> Add New Admin\r\n      </Button>\r\n    </template>\r\n  </Crud>\r\n  <ModalForm\r\n    name=\"Admin\"\r\n    :model-class=\"Admin\"\r\n    size=\"lg\"\r\n    ref=\"modal\"\r\n    @save=\"save\"\r\n  >\r\n    <template #=\"{ model }\">\r\n      <div class=\"h6 mb-3\">User Information</div>\r\n      <div class=\"mb-4\">\r\n        <StringInput :field=\"model.name\" />\r\n      </div>\r\n      <div class=\"h6 mb-3\">Login Authentication</div>\r\n      <div class=\"mb-4\">\r\n        <StringInput :field=\"model.user.username\" />\r\n      </div>\r\n      <div class=\"row mb-4\">\r\n        <div class=\"col-md-6\">\r\n          <StringInput :field=\"model.user.password\" type=\"password\" />\r\n        </div>\r\n        <div class=\"col-md-6\">\r\n          <StringInput :field=\"model.user.confirmPassword\" type=\"password\" />\r\n        </div>\r\n      </div>\r\n      <div>\r\n        <RadioInput\r\n          :field=\"model.user.status\"\r\n          :options=\"[\r\n            {\r\n              value: 'enabled',\r\n              label: 'Enabled',\r\n            },\r\n            {\r\n              value: 'disabled',\r\n              label: 'Disabled',\r\n            },\r\n            {\r\n              value: 'pending',\r\n              label: 'Pending',\r\n            },\r\n          ]\"\r\n          inline\r\n        />\r\n      </div>\r\n    </template>\r\n  </ModalForm>\r\n</template>\r\n","/**\n * Admins.vue Startup File\n *\n * @project tripoline\n * @company Codendot <https://codendot.com>\n * @author Jawdat Sobh <jawdat@codendot.com>\n * @since Thursday, August 17, 2023 at 11:34 AM GMT+3\n *\n */\n\nimport { createApp } from \"@/lib/app\"\nimport AppComponent from \"../apps/Admins.vue\"\nimport bootstrap from \"../bootstrap/Admins\"\n\nconst app = createApp(\"admins\", AppComponent)\nbootstrap(app)\napp.mount()\n"],"names":["comparedField","setComparedField","createPrivateField","validation","setValidation","CompareRule","Rule","rule","field","callback","resolve","User","Model","translate","_a","StringRule","RequiredRule","required","compare","fields","createFields","FieldType","Admin","initData","crud","ref","modal","add","_b","edit","data","save","model","done","request","api","successToast","app","createApp","AppComponent"],"mappings":"khCAMA,KAAM,CAACA,EAAeC,CAAgB,EAAIC,IAKpC,CAACC,EAAYC,CAAa,EAAIF,IAK7B,MAAMG,UAAoBC,CAAK,CACpC,MAAO,CACL,MAAM,KAAK,EAEXF,EAAc,KAAM,IACX,CAACG,EAAYP,IAClBO,EAAK,MAAM,QAAUP,EAAc,KACtC,CACH,CAEA,YAAYQ,EAAoB,CAC9B,OAAAP,EAAiB,KAAMO,CAAK,EACrB,IACT,CAEA,WAAWC,EAAyD,CACpDL,EAAA,KAAM,IAAMK,CAAQ,CACpC,CAEA,IAAI,gBAAyB,CAC3B,MAAO,8BAA8BT,EAAc,IAAI,EAAE,KAAK,EAChE,CACA,UAA6B,CACpB,OAAA,IAAI,QAASU,GAAY,CACtBA,EAAA,CAAC,KAAK,MAAM,OAASP,EAAW,IAAI,EAAE,KAAMH,EAAc,IAAI,CAAC,CAAC,CAAA,CACzE,CACH,CACF,CCpCO,MAAMW,UAAaC,CAAM,CAC/B,IAAI,IAAY,OACR,OAAA,KAAK,MAAM,KAAMC,EAAU,IAAI,IAAGC,EAAA,KAAK,WAAL,YAAAA,EAAe,KAAM,EAAE,CACjE,CAEA,IAAI,UAAkB,OACrB,OAAO,KAAK,MACX,WACAD,EAAU,UAAU,IACpBC,EAAA,KAAK,WAAL,YAAAA,EAAe,WAAY,EAAA,CAE7B,CAEA,IAAI,UAAkB,CACrB,OAAO,KAAK,MAAM,WAAYD,EAAU,UAAU,EAAG,EAAE,CACxD,CAEA,IAAI,iBAAyB,CAC5B,OAAO,KAAK,MAAM,mBAAoBA,EAAU,kBAAkB,EAAG,EAAE,CACxE,CAEA,IAAI,QAAgB,OACnB,OAAO,KAAK,MACX,SACAA,EAAU,QAAQ,IAClBC,EAAA,KAAK,WAAL,YAAAA,EAAe,SAAU,SAAA,CAE3B,CAEA,IAAI,OAAe,CACX,MAAA,CACN,CACC,CAAC,KAAK,SAAU,KAAK,SAAU,KAAK,eAAe,EACnDC,CACD,EACA,CAAC,CAAC,KAAK,QAAQ,EAAGC,CAAY,EAC9B,CACC,CAAC,KAAK,SAAU,KAAK,eAAe,EACpCA,EACCC,GAA2BA,EAAS,QAAQ,IAAM,KAAK,WAAW,CACpE,EACA,CACC,CAAC,KAAK,eAAe,EACrBZ,EACCa,GAAyBA,EAAQ,YAAY,KAAK,QAAQ,CAC5D,CAAA,CAEF,CACD,kSCvBA,MAAMC,EAASC,EACb,CACE,KAAMC,EAAU,OAChB,KAAM,KACN,MAAO,KACP,QAAS,GACT,SAAU,GACV,WAAY,EACd,EACA,CACE,KAAMA,EAAU,OAChB,KAAM,OACN,MAAO,OACP,QAAS,GACT,SAAU,GACV,WAAY,EACd,EACA,CACE,KAAMA,EAAU,OAChB,KAAM,WACN,MAAO,WACP,QAAS,GACT,SAAU,GACV,WAAY,EACd,EACA,CACE,KAAMA,EAAU,OAChB,KAAM,SACN,MAAO,SACP,QAAS,GACT,SAAU,GACV,WAAY,EACd,CAAA,EAGF,MAAMC,UAAcV,CAAM,CACxB,IAAI,IAAY,OACP,OAAA,KAAK,MAAM,KAAMC,EAAU,IAAI,IAAGC,EAAA,KAAK,WAAL,YAAAA,EAAe,KAAM,EAAE,CAClE,CAEA,IAAI,MAAc,OACT,OAAA,KAAK,MAAM,OAAQD,EAAU,MAAM,IAAGC,EAAA,KAAK,WAAL,YAAAA,EAAe,OAAQ,EAAE,CACxE,CAEA,IAAI,MAAa,CACR,OAAA,KAAK,OAAO,OAASS,GAAuB,IAAIZ,EAAKY,CAAQ,CAAC,CACvE,CAEA,IAAI,OAAe,CACV,MAAA,CACL,CAAC,CAAC,KAAK,IAAI,EAAGR,CAAU,EACxB,CAAC,CAAC,KAAK,IAAI,EAAGC,CAAY,CAAA,CAE9B,CACF,CAEM,MAAAQ,EAAOC,EAAS,IAAI,EACpBC,EAAQD,EAAS,IAAI,EAErBE,EAAM,IAAM,UAChBC,GAAAd,EAAAY,EAAM,QAAN,YAAAZ,EAAa,OAAb,MAAAc,EAAA,KAAAd,EAAoB,EAGhBe,EAAQC,GAAe,UACrBF,GAAAd,EAAAY,EAAA,QAAA,YAAAZ,EAAO,OAAP,MAAAc,EAAA,KAAAd,EAAcgB,EAAI,EAGpBC,EAAO,CAACC,EAAcC,IAAqB,CAC3C,IAAAC,EACAF,EAAM,YACRE,EAAUC,EAAI,EAAE,KAAK,UAAWH,EAAM,IAAI,EAEhCE,EAAAC,EAAA,EAAM,IAAI,WAAWH,EAAM,GAAG,KAAK,GAAIA,EAAM,IAAI,EAE7DE,EAAQ,KAAK,IAAM,OACjBE,EAAa,GAAGJ,EAAM,KAAK,KAAK,GAAI,0BAA0B,GAC9DlB,EAAAU,EAAK,QAAL,MAAAV,EAAY,UACPmB,GAAA,CACN,CAAA,4yCChGGI,GAAMC,EAAU,SAAUC,EAAY,EAE5CF,GAAI,MAAM"}